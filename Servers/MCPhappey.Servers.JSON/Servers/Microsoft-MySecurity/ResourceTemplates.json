{
  "resourceTemplates": [
    {
      "uriTemplate": "https://graph.microsoft.com/beta/auditLogs/signIns?$top={top}&$select=id,createdDateTime,appDisplayName,ipAddress,location,deviceDetail,conditionalAccessStatus,status&$filter=userId eq '{userId}' and createdDateTime ge {since}",
      "name": "my-recent-signins",
      "title": "My recent sign-ins since date",
      "description": "Lists the current user's sign-ins since a given UTC timestamp. Provide {userId} and {since} (e.g., 2025-08-01T00:00:00Z).",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/identityProtection/riskDetections?$top={top}&$select=id,detectedDateTime,riskLevel,riskEventType,ipAddress,location,userId&$filter=userId eq '{userId}' and detectedDateTime ge {since}",
      "name": "my-risk-detections",
      "title": "My risk detections since date",
      "description": "Shows identity protection risk detections for the current user since a given UTC timestamp.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/identityProtection/riskyUsers?$select=id,userPrincipalName,riskLevel,riskState,riskLastUpdatedDateTime&$filter=id eq '{userId}'",
      "name": "my-risky-user-status",
      "title": "My risky user status",
      "description": "Gets the riskyUsers record for the current user (if any). Provide {userId} as the AAD object id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/reports/authenticationMethods/userRegistrationDetails?$top=1&$select=userId,userDisplayName,userPrincipalName,isMfaRegistered,isMfaCapable,isSsprRegistered,isSsprEnabled,methodsRegistered,systemPreferredAuthenticationMethods",
      "name": "my-mfa-registration-summary",
      "title": "My MFA/SSPR registration summary",
      "description": "Fetches the authentication methods registration summary for the current user via the reports endpoint.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/methods/{methodId}",
      "name": "my-auth-method-details",
      "title": "My authentication method details",
      "description": "Gets details for a specific authentication method by id from the user's registered methods.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/emailMethods/{methodId}",
      "name": "my-email-method-details",
      "title": "My email method details",
      "description": "Gets one email authentication method by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/fido2Methods/{methodId}",
      "name": "my-fido2-method-details",
      "title": "My FIDO2 method details",
      "description": "Gets one FIDO2 authentication method by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/microsoftAuthenticatorMethods/{methodId}",
      "name": "my-authenticator-app-method-details",
      "title": "My Microsoft Authenticator app method details",
      "description": "Gets one Microsoft Authenticator app method by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/phoneMethods/{methodId}",
      "name": "my-phone-method-details",
      "title": "My phone method details",
      "description": "Gets one phone authentication method by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/softwareOathMethods/{methodId}",
      "name": "my-software-oath-method-details",
      "title": "My software OATH method details",
      "description": "Gets one software OATH authentication method by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/temporaryAccessPassMethods/{methodId}",
      "name": "my-temporary-access-pass-method-details",
      "title": "My temporary access pass method details",
      "description": "Gets one temporary access pass method by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/windowsHelloForBusinessMethods/{methodId}",
      "name": "my-windows-hello-method-details",
      "title": "My Windows Hello for Business method details",
      "description": "Gets one Windows Hello for Business method by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/platformCredentialMethods/{methodId}",
      "name": "my-platform-credential-method-details",
      "title": "My platform credential method details",
      "description": "Gets one platform credential method (passkey) by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/authentication/passwordMethods/{methodId}",
      "name": "my-password-method-details",
      "title": "My password method details",
      "description": "Gets one password method by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/deviceManagement/managedDevices/{managedDeviceId}?$select=id,deviceName,operatingSystem,osVersion,complianceState,serialNumber,manufacturer,model,azureADRegistered,lastSyncDateTime,deviceEnrollmentType,wiFiMacAddress,meid,imei",
      "name": "my-managed-device-details",
      "title": "My managed device details by id",
      "description": "Retrieves rich details for one of the current user's managed devices by id.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/deviceManagement/managedDevices/{managedDeviceId}/deviceConfigurationStates?$top={top}&$select=id,displayName,state,settingCount",
      "name": "my-device-configuration-states",
      "title": "My device configuration states",
      "description": "Lists configuration state results for a specific managed device owned by the current user.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/deviceManagement/managedDevices/{managedDeviceId}/deviceCompliancePolicyStates?$top={top}&$select=id,displayName,state,version,settingCount",
      "name": "my-device-compliance-states",
      "title": "My device compliance policy states",
      "description": "Lists compliance policy state results for a specific managed device owned by the current user.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/me/ownedDevices?$top={top}&$select=id,displayName,deviceId,operatingSystem",
      "name": "my-owned-devices",
      "title": "My owned devices",
      "description": "Lists devices owned by the current user from directory perspective (can differ from managed devices).",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/auditLogs/directoryAudits?$top={top}&$select=id,activityDateTime,activityDisplayName,initiatedBy,result,category,targetResources&$filter=initiatedBy/user/id eq '{userId}' and activityDateTime ge {since}",
      "name": "my-directory-audit-events",
      "title": "My directory audit events since date",
      "description": "Shows directory audit events initiated by the current user from a given UTC timestamp onward.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    },
    {
      "uriTemplate": "https://graph.microsoft.com/beta/oauth2PermissionGrants?$top={top}&$select=id,clientId,consentType,principalId,resourceId,scope&$filter=principalId eq '{userId}'",
      "name": "my-oauth-consent-grants",
      "title": "My app consent grants",
      "description": "Lists OAuth2 permission grants (app consents) where the current user is the principal.",
      "mimeType": "application/json",
      "annotations": {
        "audience": [
          "assistant"
        ]
      }
    }
  ]
}
